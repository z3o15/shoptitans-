# 更新日志

本文档记录了游戏装备图像识别系统的所有重要变更和版本更新。

## [2.0.0] - 2025-11-22

### 🎉 重大更新

#### 新增功能
- **双重算法架构**：引入高级模板匹配算法，与传统dHash算法并存
- **增强版识别器**：新增 `EnhancedEquipmentRecognizer` 类，支持算法动态切换
- **独立模块系统**：新增 `standalone_modules` 目录，提供独立的高级识别器实现
- **统一配置管理**：新增 `ConfigManager` 类和 `config.json` 配置文件
- **交互式启动脚本**：新增 `start.py` 交互式启动界面

#### 技术改进
- **高级模板匹配算法**：
  - 基于OpenCV的高精度图像匹配
  - 支持掩码匹配，排除背景干扰
  - 集成直方图验证，提供颜色信息对比
  - 综合评分机制，提高识别准确性
- **智能算法选择**：根据精度和速度需求自动选择最佳算法
- **动态配置更新**：支持运行时修改配置参数
- **性能优化**：支持缓存和并行处理

#### 新增文件
- `src/config_manager.py` - 配置管理模块
- `standalone_modules/advanced_matcher_standalone.py` - 高级识别器独立实现
- `standalone_modules/__init__.py` - 模块初始化
- `config.json` - 统一配置文件
- `start.py` - 交互式启动脚本
- `examples/enhanced_recognizer_usage.py` - 增强版识别器使用示例
- `CHANGELOG.md` - 更新日志
- `TECHNICAL_SPECIFICATION.md` - 技术规格文档

#### API 变更
- `EquipmentRecognizer` 类保持向后兼容
- 新增 `EnhancedEquipmentRecognizer` 类：
  - `set_algorithm_mode(use_advanced: bool)` - 切换算法模式
  - `get_algorithm_info()` - 获取当前算法信息
  - `recognize_equipment_advanced()` - 高级算法识别
  - `batch_recognize()` - 批量识别功能

#### 配置系统
- 新增统一配置文件 `config.json`，包含：
  - `recognition` - 识别算法配置
  - `cutting` - 切割参数配置
  - `paths` - 路径配置
  - `logging` - 日志配置
  - `performance` - 性能配置
  - `ui` - 界面配置

#### 性能提升
- **识别精度**：高级算法在理想条件下准确率 > 98%
- **处理速度**：传统算法 < 10ms，高级算法 < 50ms
- **内存优化**：支持缓存机制，减少重复计算
- **并行处理**：支持多线程并行处理

### 🔧 破坏性变更

#### 目录结构调整
- 新增 `standalone_modules/` 目录
- 新增 `recognition_logs/` 目录
- 图像目录结构优化，支持多子目录

#### 配置方式变更
- 旧版本：直接修改代码中的参数
- 新版本：通过 `config.json` 文件管理配置
- 提供向后兼容的配置迁移

### 📚 文档更新

- 全面更新 `README.md`，包含新功能介绍
- 重写 `PROJECT.md`，反映最新架构
- 更新 `USAGE.md`，添加配置系统说明
- 新增 `TECHNICAL_SPECIFICATION.md`，详细技术规格
- 新增 `CHANGELOG.md`，记录版本变更

### 🐛 错误修复

- 修复轮廓检测切割的边界情况处理
- 改进图像预处理的错误处理机制
- 修复批量处理中的内存泄漏问题
- 优化配置文件的错误提示

### 🔄 升级指南

#### 从 1.x 升级到 2.0

1. **备份现有配置**：
   ```bash
   cp src/main.py src/main.py.backup
   ```

2. **更新代码**：
   ```bash
   git pull origin main
   ```

3. **安装新依赖**：
   ```bash
   pip install -r requirements.txt
   ```

4. **配置迁移**：
   - 程序会自动创建 `config.json` 默认配置
   - 根据需要调整配置文件中的参数

5. **测试新功能**：
   ```bash
   python start.py  # 使用交互式启动脚本
   ```

#### 兼容性说明

- 原有的 `EquipmentRecognizer` 类保持完全兼容
- 现有的脚本和代码无需修改即可继续使用
- 建议逐步迁移到新的配置系统和增强版识别器

---

## [1.2.0] - 2024-11-20

### 新增功能
- **智能轮廓检测切割**：基于形状和大小特征的精确切割
- **自动切割模式选择**：根据截图特征自动选择最佳切割方式
- **批量处理优化**：改进批量处理的性能和稳定性
- **详细日志系统**：新增日志记录和错误追踪

### 改进
- 优化dHash算法的性能
- 改进图像预处理流程
- 增强错误处理机制

### 修复
- 修复固定坐标切割的边界计算问题
- 解决大图像处理的内存溢出问题

---

## [1.1.0] - 2024-11-15

### 新增功能
- **固定坐标切割**：支持装备位置固定的界面
- **批量比较功能**：支持同时处理多个装备图像
- **结果导出**：支持JSON格式的结果导出

### 改进
- 优化图像相似度计算算法
- 改进用户界面和交互体验

---

## [1.0.0] - 2024-11-01

### 初始发布
- **基础dHash算法**：实现图像相似度比较
- **截图切割功能**：支持基本的图像切割
- **简单命令行界面**：提供基本的操作接口
- **核心功能验证**：MVP版本，验证核心功能可行性

---

## 版本说明

### 版本号规则

本项目采用 [语义化版本](https://semver.org/lang/zh-CN/) 规范：

- **主版本号**：不兼容的API修改
- **次版本号**：向下兼容的功能性新增
- **修订号**：向下兼容的问题修正

### 更新类型说明

- 🎉 **重大更新**：重要功能、架构变更或重大改进
- ✨ **新增功能**：新的功能特性
- 🔧 **改进优化**：现有功能的改进和优化
- 🐛 **错误修复**：bug修复和问题解决
- 📚 **文档更新**：文档的更新和改进
- 🔒 **安全更新**：安全相关的修复和改进
- ⚡ **性能优化**：性能相关的优化
- 🔄 **重构**：代码重构，不涉及功能变更

### 获取更新

#### 稳定版本
- 通过Git标签获取：`git checkout v2.0.0`
- 下载发布版本的压缩包

#### 开发版本
- 克隆主分支：`git clone -b main`
- 查看最新开发进展

### 反馈与贡献

欢迎通过以下方式提供反馈和贡献：

- 提交 [Issue](../../issues) 报告问题或建议功能
- 提交 [Pull Request](../../pulls) 贡献代码
- 查看 [贡献指南](CONTRIBUTING.md) 了解贡献流程

---

*最后更新：2025年11月22日*
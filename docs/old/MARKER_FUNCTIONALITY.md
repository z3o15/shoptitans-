# 带圆形标记副本功能说明

## 功能概述

本功能为装备识别系统添加了带圆形标记的副本功能，可以在切割装备图片时自动创建带有圆形标记的副本，并在识别完成后为文件添加不同的后缀。

## 工作流程

### 1. 切割阶段（步骤2）

当系统执行装备图片切割时，会同时创建两个目录：

- **主目录**: `images/cropped_equipment/时间文件夹/`
  - 存放第二次处理的图片（圆形标记处理后的图片）
  - 文件名格式：`01.png`, `02.png`, `03.png`...

- **标记副本目录**: `images/cropped_equipment_marker/时间文件夹/`
  - 存放第一次处理的图片（带圆形标记的图片）
  - 文件名格式与主目录完全相同：`01.png`, `02.png`, `03.png`...

### 2. 识别阶段（步骤3）

当系统完成装备识别后，只会为主目录的文件添加装备名称后缀：

- **主目录文件重命名**：
  - 原文件名：`09.png`
  - 重命名后：`09_noblering.png`（添加装备名称后缀）

- **标记副本目录文件**：
  - 保持原始文件名不变：`09.png`
  - 这些文件是为后续金额识别准备，不在此阶段修改

## 文件结构示例

```
images/
├── cropped_equipment/
│   └── 20251122_172509/
│       ├── 01.png
│       ├── 02.png
│       ├── 03.png
│       ├── 09_noblering.png    # 识别后添加装备名称
│       └── 10_target_equipment_1.png
│
└── cropped_equipment_marker/
    └── 20251122_172509/
        ├── 01.png              # 第一次处理的图片（带圆形标记）
        ├── 02.png              # 文件名保持不变
        ├── 03.png
        ├── 09.png              # 为后续金额识别准备
        └── 10.png
```

## 优势

1. **保留原始信息**：通过添加后缀而非完全重命名，保留了原始文件编号信息
2. **避免文件冲突**：不会因为多个相同装备导致文件名冲突
3. **区分用途**：主目录显示装备名称，marker目录保持原始文件名用于金额识别
4. **处理阶段分离**：marker目录保存第一次处理结果，主目录保存第二次处理结果
5. **金额识别准备**：marker目录中的文件为后续金额识别功能准备

## 配置说明

当前金额固定为"1000"，未来可以通过配置文件或数据库动态获取。

## 清理功能

清理功能会同时清理两个目录中的文件，确保系统整洁。

## 使用方法

1. 运行 `run_recognition_start.py` 执行完整工作流程
2. 系统会自动创建带圆形标记的副本
3. 识别完成后会自动添加相应的后缀
4. 可以通过菜单选项11清理所有结果

## 注意事项

1. 确保有足够的磁盘空间存储副本文件
2. 两个目录的时间文件夹结构会保持完全一致
3. marker目录中的文件在识别阶段不会被重命名，保持原始文件名
4. marker目录中的文件是为后续金额识别功能准备的